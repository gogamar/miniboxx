<nav class="bg-white shadow pb-2 border-b border-slate-300" data-controller='toggle'>
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="flex h-16 justify-between">
      <div class="flex">
        <div class="-ml-2 mr-2 flex items-center md:hidden">
          <!-- Mobile menu button -->
          <button type="button" class="relative inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-sky-500" aria-controls="mobile-menu" aria-expanded="false" data-action='click->toggle#toggle touch->toggle#toggle'>
            <span class="absolute -inset-0.5"></span>
            <span class="sr-only"><%= t('open_main_menu') %></span>
            <svg class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
            </svg>
            <svg class="hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="flex justify-between gap-8">
          <div class="flex flex-shrink-0 items-end">
            <%= image_tag("logo.svg", class: "h-8 w-auto", alt: "Miniboxx") %>
          </div>
          <div class="hidden md:ml-6 md:flex md:space-x-8">
            <% desktop_current = "border-sky-500 text-gray-900" %>
            <% desktop_default = "border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700" %>
            <!-- Current: "border-sky-500 text-gray-900", Default: "border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700" -->
            <%= link_to t('home'), root_path, class: "inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium #{ current_page?(root_path) ? desktop_current : desktop_default }" %>
            <%= link_to t('products'), variants_path, class: "inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium #{ current_page?(variants_path) ? desktop_current : desktop_default }" %>
            <%= link_to t('about_us'), about_path, class: "inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium #{ current_page?(about_path) ? desktop_current : desktop_default }" %>
            <%= link_to t('contact'), contact_path, class: "inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium #{ current_page?(contact_path) ? desktop_current : desktop_default }" %>
          </div>
        </div>
      </div>
      <div class="flex items-center">
        <%# button %>
        <div class="hidden md:ml-4 md:flex md:flex-shrink-0 md:items-center">
          <!-- Profile dropdown -->
          <% if user_signed_in? %>
            <div class="relative ml-3" data-controller="dropdown" data-action="click->dropdown#toggle click@window->dropdown#hide">
              <div>
                <button type="button" class="relative flex rounded-full bg-white text-sm focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2" id="user-menu-button" aria-expanded="false" aria-haspopup="true" data-dropdown-target="button">
                  <span class="absolute -inset-1.5"></span>
                  <span class="sr-only"><%= t('open_user_menu') %></span>
                  <img class="h-8 w-8 rounded-full" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="">
                </button>
              </div>
              <div class="absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none" role="menu" aria-orientation="vertical" aria-labelledby="user-menu-button" tabindex="-1"
            data-dropdown-target="menu"
            data-transition-enter="transition ease-out duration-200"
            data-transition-enter-from="opacity-0 translate-y-1"
            data-transition-enter-to="opacity-100 translate-y-0"
            data-transition-leave="transition ease-in duration-150"
            data-transition-leave-from="opacity-100 translate-y-0"
            data-transition-leave-to="opacity-0 translate-y-1"
            >
                <!-- Active: "bg-gray-100", Not Active: "" -->
                <% if user_signed_in? && current_user.admin? %>
                  <%= link_to t('add_product'), new_product_path, class: "block px-4 py-2 text-sm text-gray-700", role: "menuitem", tabindex: "-1" %>
                  <%= link_to t('upload_products'), upload_form_path, class: "block px-4 py-2 text-sm text-gray-700", role: "menuitem", tabindex: "-1" %>
                <% end %>
                <a href="#" class="block px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1" id="user-menu-item-0"><%= t('your_profile') %></a>
                <a href="#" class="block px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1" id="user-menu-item-1"><%= t('settings') %></a>
                <a href="#" class="block px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1" id="user-menu-item-2"><%= t('sign_out') %></a>
              </div>
            </div>
          <% else %>
            <div class="relative ml-3">
              <%= link_to t('sign_in'), new_user_session_path, class: "font-semibold text-sky-600 hover:text-cyan-500" %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <!-- Mobile menu, show/hide based on menu state. -->
  <div class="hidden" id="mobile-menu" data-toggle-target='toggleable'>
    <div class="space-y-1 pb-3 pt-2">
      <!-- Current: "bg-cyan-50 border-sky-500 text-sky-700", Default: "border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700" -->
      <% mobile_current = "bg-cyan-50 border-sky-500 text-sky-700" %>
      <% mobile_default = "border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700" %>
      <%= link_to t('home'), root_path, class: "block border-l-4 py-2 pl-3 pr-4 text-base font-medium sm:pl-5 sm:pr-6 #{ current_page?(root_path) ? mobile_current : mobile_default }" %>
      <%= link_to t('about_us'), about_path, class: "block border-l-4 py-2 pl-3 pr-4 text-base font-medium sm:pl-5 sm:pr-6 #{ current_page?(about_path) ? mobile_current : mobile_default }" %>
      <%= link_to t('contact'), contact_path, class: "block border-l-4 py-2 pl-3 pr-4 text-base font-medium sm:pl-5 sm:pr-6 #{ current_page?(contact_path) ? mobile_current : mobile_default }" %>
    </div>
    <% if user_signed_in? %>
      <div class="border-t border-gray-200 pb-3 pt-4 bg-sky-500">
        <div class="flex items-center px-4 sm:px-6">
          <div class="flex-shrink-0">
            <img class="h-10 w-10 rounded-full" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="">
          </div>
          <div class="ml-3">
            <div class="text-base font-medium text-gray-800"><%= current_user.first_name %> <%= current_user.last_name %></div>
            <div class="text-sm font-medium text-gray-500"><%= current_user.email %></div>
          </div>
        </div>
        <div class="mt-3 space-y-1">
          <a href="#" class="block px-4 py-2 text-base font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-800 sm:px-6"><%= t('your_profile') %></a>
          <a href="#" class="block px-4 py-2 text-base font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-800 sm:px-6"><%= t('settings') %></a>
          <a href="#" class="block px-4 py-2 text-base font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-800 sm:px-6"><%= t('sign_out') %></a>
        </div>
      </div>
    <% end %>
  </div>
</nav>
